# TMCloud データベース分析レポート

## 概要

2025年7月21日に実施したtmcloud_tsv.dbのデータベース構造調査の結果をまとめます。

## 1. データベースの現状

### 1.1 データが存在するテーブル

| テーブル名 | レコード数 | 説明 |
|-----------|-----------|------|
| jiken_c_t | 16,688 | 事件（出願）基本情報 |
| jiken_c_t_shohin_joho | 33,385 | 商品・役務情報（類と指定商品） |
| jiken_c_t_kian_dv | 11,775 | 拒絶理由通知情報 |
| jiken_c_t_sinsei_dv | 16,682 | 各種申請情報 |
| jiken_c_t_yusenken_joho | 327 | 優先権情報 |
| mgt_info_t | 16,884 | 管理情報 |

### 1.2 データが存在しないテーブル（重要）

| テーブル名 | 用途 | 影響 |
|-----------|------|------|
| standard_char_t_art | 標準文字商標テキスト | 商標名が表示できない |
| indct_use_t_art | 称呼商標テキスト | 商標名が表示できない |
| search_use_t_art_table | 検索用商標テキスト | 商標名が表示できない |
| t_knd_info_art_table | 類似群コード | 類似群コードが表示できない |
| right_person_art_t | 権利者情報 | 権利者名が表示できない |
| jiken_c_t_shutugannindairinin | 出願人・代理人情報 | 出願人名が表示できない |

## 2. 主要な問題点

### 2.1 商標テキスト情報の欠如
- 3つの商標テキストテーブル（standard_char_t_art、indct_use_t_art、search_use_t_art_table）がすべて空
- 商標の名称を表示することができない

### 2.2 類似群コード情報の欠如
- t_knd_info_art_tableテーブルが空
- 類似群コードによる検索・分類ができない

### 2.3 出願人・権利者情報の欠如
- jiken_c_t_shutugannindairininとright_person_art_tテーブルが空
- 出願人や権利者の名前・住所を表示できない

### 2.4 登録番号の取得方法
- jiken_c_tテーブルのreg_reg_ymdカラムは「登録日」であり「登録番号」ではない
- 実際の登録番号を格納するカラムが見当たらない

## 3. データベース間の関係

### 3.1 jiken_c_tとjiken_c_t_shohin_johoの関係
- 両テーブルはapp_num（出願番号）で紐づいている
- 紐づき率: 100%（全ての出願に商品情報が存在）

### 3.2 登録状況
- 総出願数: 16,688件
- 登録済み（reg_reg_ymdが存在）: 4,557件（約27.3%）

## 4. tmcloud_search_table.pyの修正内容

### 4.1 主な修正点

1. **商標テキスト取得の削除**
   - データが存在しないため、商標テキスト表示機能を削除

2. **類似群コード取得の削除**
   - データが存在しないため、類似群コード表示機能を削除

3. **出願人・権利者情報取得の削除**
   - データが存在しないため、出願人・権利者表示機能を削除

4. **テーブル表示項目の調整**
   - 実際に取得可能な情報のみを表示するように変更
   - 最終処分状態の表示を追加
   - 標準文字フラグの表示を追加

5. **警告メッセージの追加**
   - データ制限事項を明示的に表示

### 4.2 表示可能な情報

- 出願番号
- 出願日
- 最終処分種別・日付
- 登録日（登録番号ではない）
- 商品区分（類）
- 指定商品・役務
- 標準文字商標フラグ
- 区分数

## 5. 推奨事項

### 5.1 短期的対応
1. 現在の制限事項を明確にユーザーに伝える
2. 利用可能な情報のみで検索・表示機能を提供

### 5.2 長期的対応
1. 不足しているTSVファイルのインポート処理を実行
   - standard_char_t_art.tsv
   - t_knd_info_art_table.tsv
   - right_person_art_t.tsv
   - その他の空テーブル用TSVファイル

2. TSV_COLUMN_SPECIFICATIONS.mdに記載されている正しいカラム定義に基づいてインポート処理を修正

3. 登録番号を格納するための適切なテーブル・カラムの追加検討

## 6. 結論

現在のデータベースは基本的な出願情報と商品情報は保持しているものの、商標検索システムとして重要な以下の情報が欠落しています：

- 商標テキスト（商標名）
- 類似群コード
- 出願人・権利者情報
- 正確な登録番号

これらの情報をインポートすることで、より完全な商標検索システムとして機能することが期待されます。