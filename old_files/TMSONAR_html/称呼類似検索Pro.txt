<head>
    <meta charset="UTF-8">
    <title>TM-SONAR</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/style.css?t=1747629564">
    <link rel="stylesheet" href="/css/SplitView.css">
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/themes/smoothness/jquery-ui.css" rel="stylesheet">
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="/js/jquery-3.3.1.min.js"></script>
    <script src="/js/SpritView.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/app.js?t=1747629565"></script>
</head>
<body class="lang-ja" style="font-family: sans-serif; min-width: 1200px;">

<nav class="navbar navbar-default no-print no-print-with-modal">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="/?lang=ja" onclick="app.cleaning();"><img src="/images/tm_logo.png" style="height: 20px;"></a>
            <span class="navbar-brand navbar-brand-en" style="display: none;">英語版</span>
        </div>
        <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                                    <li><a href="/?lang=ja" onclick="app.cleaning();">メインメニュー</a></li>
                            </ul>
            <ul class="nav navbar-nav navbar-right">
                                                    <li class="manual-nav"><a href="/manual?lang=ja&amp;tb" target="_blank">操作説明資料</a></li>
                                                    <li class="news-nav"><a href="/news?lang=ja&amp;tb" target="_blank">収録期間</a></li>
                                                    <li><a href="javascript:app.showSettingsModal();">設定</a></li>
                                                    <li><a href="/logout"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> US090 ログアウト</a></li>
                                <li class="navbar-text" id="charge-nums" style="">検索: 0件

            書誌: 0件
    

    </li>
            </ul>
        </div>
    </div>
</nav>

<div id="list-header" class="no-print no-print-with-modal" style="display: none;">
    <button type="button" class="btn btn-default btn-sm" id="search-condition-btn" style="width: 120px;">件数一覧に戻る</button>
</div>

<div id="count-form-header" class="count-form no-print-with-modal" style="display: none;">
    <button type="button" class="btn btn-default btn-sm" id="count-list-back-btn" style="width: 120px;">検索条件に戻る</button>
</div>

<div style="display: none;" class="no-print-with-modal">
    <!-- 称呼Std -->
<div id="help-shoko-std">
    ・１称呼のみ検索可能です。複数の称呼の同時検索はできません。<br>
    ・全角・半角、ひらがな・カタカナで検索できます。<br>
    　※全て半角カタカナに変換して検索されます（DB上のデータもカタカナで統一）<br>
    ・要部固定での検索のため、部分一致での検索（クエスチョンマークにて指定）はできません。<br>
    <br>
    ※類似群コードまたは国際分類とは、ＡＮＤ検索となります。
</div>

<!-- 称呼Pro -->
<div id="help-shoko-pro">
    ・最大２０称呼までの同時検索が可能です。改行、カンマ、スペースにて区切って入力ください。<br>
    ・全角・半角、ひらがな・カタカナで検索できます。<br>
    　※全て半角カタカナに変換して検索されます（DB上のデータもカタカナで統一）<br>
    ・類似検索と同一レベルの完全一致、部分一致（前方・後方・中間）の検索が可能です。<br>
    <br>
    ※類似群コードまたは国際分類とは、ＡＮＤ検索となります。
</div>

<!-- 類似群コード -->
<div id="help-ruijigun">
    ・完全一致および前方一致検索（クエスチョンマークを末尾指定）が可能です。<br>
    　Ex.　11?→　類似群コード先頭２桁が11で始まる類似群コードを全て検索<br>
    ・複数指定の場合は、スペースまたはカンマで指定します。<br>
    ・全角、半角、英大文字／小文字での指定が可能です。<br>
    <br>
    ※類似群コードと国際分類を両方入力しない場合は、<b>全類検索</b>となります。<br>
    ※類似群コードと国際分類を両方入力した場合は、ＯＲ検索となります。<br>
    ※小売から商品へのクロスサーチ及び備考類似の自動展開はおこなっておりません。
</div>

<!-- 国際分類 -->
<div id="help-kokusaibunrui">
    国際分類を数字２桁にて指定してください<br>
    国際分類第12版に基づき、類似群コードに展開した上で検索を行います<br>
    国際分類と類似群コードの対応は、次の２つを基準としております。<br>
    　<a href="https://www.jpo.go.jp/system/laws/rule/guideline/trademark/ruiji_kijun/ruiji_kijun12-2025.html" target="_blank">類似商品・役務審査基準【国際分類第12版対応】</a>※<br>
    　　※１：「極めて希な商品に使用した類似群コード」は、コード右に記載されている<br>
    　　　　　国際分類に含めております。<br>
    　　※２：「仮類似群コード」は、類似群コード先頭2桁が同一の類似群コードが属する<br>
    　　　　　国際分類すべてに含めております。<br>
    　<a href="https://www.jpo.go.jp/system/laws/rule/guideline/trademark/kokusai_bunrui/kokusai_bunrui_12-2025.html" target="_blank">ニース協定に基づく国際分類第12版（商品・サービス国際分類表）</a><br>
    <br>
    ※類似群コードと国際分類を両方入力しない場合は、<b>全類検索</b>となります。<br>
    ※類似群コードと国際分類を両方入力した場合は、ＯＲ検索となります。<br>
    ※小売から商品へのクロスサーチ及び備考類似の自動展開はおこなっておりません。
</div>

<!-- 権利、登録 -->
<div id="help-kenri-touroku">
    選択したデータに限定して検索<br>
    <br>
    ※他の条件とは、ＡＮＤ検索となります。
</div>

<!-- 称呼抽出 -->
<div id="help-shoko-search">
    入力された商標から特許庁公開データの称呼を抽出します。<br>
    称呼検索を行うとき、調査対象商標が漢字・外国語・造語などの場合一つの商標から<br>
    複数の称呼が考えられ、検索者は検索漏れをおこさない為にも、それぞれの称呼を<br>
    入力し検索をおこなう必要があります。<br>
    称呼抽出機能では特許庁公開データ内の同一商標名である他の商標で作成されている<br>
    称呼を、全ての区分を対象に検索・抽出することができます。<br>
    <br>
    ※このデータは商標の要部が１つのもののみ採用しています。<br>
    二段併記など複数要部で構成された商標は収録しておりません。<br>
    また、図形などがついている商標の場合、図形部分も称呼作成されている事が<br>
    ございますので、商標名から見て不要な称呼も含まれていることがございます。
</div>

<!-- 補助ボタン -->
<div id="help-assist-btn">
    指定商品・役務と類似群コードの対応一覧の検索が行えます。<br>
    指定商品・役務から類似群を特定する場合にご利用ください。<br>
    ＜データ源＞<br>
    ・類似商品・役務審査基準[第12版](英語訳付)<br>
    ・ニース協定に基づく国際分類対訳表[第12版]<br>
    ・特許庁公開データの審査済み登録データ<br>
    　※１区分に単一の指定商品・役務で登録になったもののみ掲載
</div>
</div>

<form action="javascript:;" class="search-form search-condition no-print-with-modal" id="search-condition-form">

<div class="container" style="width: 800px;">
    <div class="alert alert-danger error" style="display: none;"></div>
    
    <div class="row" style="margin-bottom: 20px;">
        <div class="col-md-7 form-inline">
            <select class="form-control" id="saved-condition"><option value="">条件設定はありません</option></select>
            <button type="button" class="btn btn-default" id="condition-save-modal-btn">条件設定</button>
            <button type="button" class="btn btn-default condition-clear-btn">クリア</button>
        </div>
        <div class="col-md-5 text-right">
            <button type="button" class="btn btn-primary same-search-btn" id="search-btn" style="width: 80px;" data-loading-text="<i class='fa fa-spinner fa-spin'></i> 検索">検索</button>
        </div>
    </div>
    
    <div class="panel panel-default">
    <div class="panel-body" style="padding: 5px; text-align: center;">
        <div class="header-condition">
            <table style="width: 100%;">
                <tbody><tr>
                    <td>
                        <button type="button" class="btn btn-default" id="search-filter-btn"><span class="glyphicon glyphicon-minus" aria-hidden="true"></span></button>
                    </td>
                    <td style="width: 280px; text-align: left;">
                        <input type="hidden" name="cb_0" value="0">
                        <span class="search-filter-label">権利存続＋失効１０年＋出願却下を除く</span>
                    </td>
                    <td>
                        <span style="margin: 0 10px; color: #999999;">AND</span>
                    </td>
                    <td>
                        <div class="radio">
                            <label><input type="radio" name="cb_1" value="0" checked="">全て</label>
                            <label><input type="radio" name="cb_1" value="1">登録済</label>
                            <label><input type="radio" name="cb_1" value="2">未登録</label>
                        </div>
                    </td>
                </tr>
                <tr id="search-filter-form-row">
                    <td colspan="4" style="text-align: left;">
                        <div class="checkbox" style="margin-bottom: 5px;">
                            <label><input type="checkbox" class="search-filter-check" name="sonzoku_kind" value="1" checked="checked"><span>権利存続</span></label>
                            <label><input type="checkbox" class="search-filter-check exclusive-check" name="sikko_kind" value="1"><span>失効５年</span></label>
                            <label><input type="checkbox" class="search-filter-check exclusive-check" name="sikko_kind" value="2" checked="checked"><span>失効１０年</span></label>
                            <label><input type="checkbox" class="search-filter-check exclusive-check" name="sikko_kind" value="3"><span>失効全て</span></label>
                            <label><input type="checkbox" class="search-filter-check" name="shukya_kind" value="1" checked="checked"><span>出願却下を除く</span></label>
                        </div>
                    </td>
                </tr>
            </tbody></table>
        </div>
    </div>
</div>
    <table class="condition-table">
    <tbody><tr>
        <td class="condition-title">称呼</td>
        <td class="condition-help-icon">
            <span class="glyphicon glyphicon-question-sign type-help-icon" aria-hidden="true" onclick="app.toggleHelpRow('shoko-pro');"></span>
        </td>
        <td class="condition-input" style="width: 0;">
            <textarea name="names" class="form-control dictionary-search-names" style="width: 250px; height: 300px; min-height: 300px;"></textarea>
        </td>
        <td style="padding-left: 15px;">
            <div class="input-group" role="group">
                <input type="text" class="form-control dictionary-search-shohyo" placeholder="商標から称呼を検索できます" maxlength="2000">
                <div class="input-group-btn">
                    <button type="button" class="btn btn-default shoko-dictionary-search-btn" data-loading-text="<i class='fa fa-spinner fa-spin '></i> 検索中">検索</button>
                </div>
            </div>
            <div class="shoko-dictionary-search-result" style="height: 226px; overflow-y: auto;"></div>
            <div style="margin-top: 5px;">
                <button type="button" class="btn btn-default btn-block set-shoko-dictionary-item-btn">←リストで選択した称呼をセット</button>
            </div>
        </td>
    </tr>
    <tr style="display: none;">
        <td></td>
        <td></td>
        <td colspan="2" class="help help-shoko-pro"></td>
    </tr>
</tbody></table>
    <div style="text-align: center; padding: 15px;">AND</div>
    <table class="condition-table">
    <tbody><tr>
        <td class="condition-title">類似群コード</td>
        <td class="condition-help-icon">
            <span class="glyphicon glyphicon-question-sign type-help-icon" aria-hidden="true" onclick="app.toggleHelpRow('ruijigun');"></span>
        </td>
        <td class="condition-input form-inline" style="display: table;">
            <textarea name="similar_code" class="form-control text-one-line" maxlength="2000" style="width: 100%;"></textarea>
            <div style="width: 1%; display: table-cell; padding-left: 5px;">
                <button type="button" class="btn btn-default dictionary-btn" data-name="similar_code" data-type="106">補助</button>
            </div>
        </td>
    </tr>
    <tr style="display: none;">
        <td></td>
        <td></td>
        <td class="help help-ruijigun"></td>
    </tr>
    <tr>
        <td colspan="3" class="condition-spacer-row"></td>
    </tr>
    <tr>
        <td class="condition-title">国際分類</td>
        <td class="condition-help-icon">
            <span class="glyphicon glyphicon-question-sign type-help-icon" aria-hidden="true" onclick="app.toggleHelpRow('kokusaibunrui');"></span>
        </td>
        <td class="condition-input">
            <textarea name="international_class" class="form-control text-one-line" maxlength="2000"></textarea>
        </td>
    </tr>
    <tr style="display: none;">
        <td></td>
        <td></td>
        <td class="help help-kokusaibunrui"></td>
    </tr>
</tbody></table>

    <div class="exp" style="margin-top: 20px;">
        ※称呼（必須）、類似群コード（任意）、国際分類（任意）を入力後、検索実行ボタンを押してください。<br>
        ※商標を入力して横の検索ボタンを押すと、公開データで付与済みの称呼を参照できます。<br>
        ※国際分類は類似群コードに展開して検索をおこないます。<br>
        ※類似群コードと国際分類を両方入力しない場合は、全類検索となります。<br>
        ※類似群コードと国際分類を両方入力した場合にはOR検索となります。<br>
        ※結果一覧または絞込みリストを表示した時点で課金となります。<br>
        ※称呼入力補助では称呼件数を集計して多い順に出力します。<br>
    </div>
</div>

</form>
<form action="javascript:;" class="search-form search-condition no-print-with-modal" id="add-shoko-search-form" style="display: none;">
    <div class="container" style="width: 780px;">
        <div class="alert alert-danger error" style="display: none;"></div>

        <div class="row" style="margin-bottom: 20px;">
            <div class="col-md-8 form-inline">
                <button type="button" class="btn btn-default cancel-search-btn">キャンセル</button>
            </div>
            <div class="col-md-4 text-right">
                <button type="button" class="btn btn-primary same-search-btn" id="add-shoko-search-btn" style="width: 150px;" data-loading-text="<i class='fa fa-spinner fa-spin'></i> 称呼追加">称呼追加</button>
            </div>
        </div>

        <table class="condition-table">
    <tbody><tr>
        <td class="condition-title">称呼</td>
        <td class="condition-help-icon">
            <span class="glyphicon glyphicon-question-sign type-help-icon" aria-hidden="true" onclick="app.toggleHelpRow('shoko-pro');"></span>
        </td>
        <td class="condition-input" style="width: 0;">
            <textarea name="names" class="form-control dictionary-search-names" style="width: 250px; height: 300px; min-height: 300px;"></textarea>
        </td>
        <td style="padding-left: 15px;">
            <div class="input-group" role="group">
                <input type="text" class="form-control dictionary-search-shohyo" placeholder="商標から称呼を検索できます" maxlength="2000">
                <div class="input-group-btn">
                    <button type="button" class="btn btn-default shoko-dictionary-search-btn" data-loading-text="<i class='fa fa-spinner fa-spin '></i> 検索中">検索</button>
                </div>
            </div>
            <div class="shoko-dictionary-search-result" style="height: 226px; overflow-y: auto;"></div>
            <div style="margin-top: 5px;">
                <button type="button" class="btn btn-default btn-block set-shoko-dictionary-item-btn">←リストで選択した称呼をセット</button>
            </div>
        </td>
    </tr>
    <tr style="display: none;">
        <td></td>
        <td></td>
        <td colspan="2" class="help help-shoko-pro"></td>
    </tr>
</tbody></table>

        <div class="exp" style="margin-top: 20px;">
            ※商標を入力して横の検索ボタンを押すと、公開データで付与済みの称呼を参照できます。<br>
            ※称呼入力補助では称呼件数を集計して多い順に出力します。<br>
        </div>
    </div>
</form>
<form action="javascript:;" class="search-form search-condition no-print-with-modal" id="change-search-condition-form" style="display: none;">

<div class="container" style="width: 780px;">
    <div class="alert alert-danger error" style="display: none;"></div>
    
    <div class="row" style="margin-bottom: 20px;">
        <div class="col-md-8 form-inline">
            <button type="button" class="btn btn-default cancel-search-btn">キャンセル</button>
        </div>
        <div class="col-md-4 text-right">
            <button type="button" class="btn btn-primary same-search-btn" id="change-search-btn" style="width: 150px;" data-loading-text="<i class='fa fa-spinner fa-spin'></i> 検索条件変更">検索条件変更</button>
        </div>
    </div>

    <div class="panel panel-default">
    <div class="panel-body" style="padding: 5px; text-align: center;">
        <div class="header-condition">
            <table style="width: 100%;">
                <tbody><tr>
                    <td>
                        <button type="button" class="btn btn-default" id="search-filter-btn"><span class="glyphicon glyphicon-minus" aria-hidden="true"></span></button>
                    </td>
                    <td style="width: 280px; text-align: left;">
                        <input type="hidden" name="cb_0" value="0">
                        <span class="search-filter-label">権利存続＋失効１０年＋出願却下を除く</span>
                    </td>
                    <td>
                        <span style="margin: 0 10px; color: #999999;">AND</span>
                    </td>
                    <td>
                        <div class="radio">
                            <label><input type="radio" name="cb_1" value="0" checked="">全て</label>
                            <label><input type="radio" name="cb_1" value="1">登録済</label>
                            <label><input type="radio" name="cb_1" value="2">未登録</label>
                        </div>
                    </td>
                </tr>
                <tr id="search-filter-form-row">
                    <td colspan="4" style="text-align: left;">
                        <div class="checkbox" style="margin-bottom: 5px;">
                            <label><input type="checkbox" class="search-filter-check" name="sonzoku_kind" value="1" checked="checked"><span>権利存続</span></label>
                            <label><input type="checkbox" class="search-filter-check exclusive-check" name="sikko_kind" value="1"><span>失効５年</span></label>
                            <label><input type="checkbox" class="search-filter-check exclusive-check" name="sikko_kind" value="2" checked="checked"><span>失効１０年</span></label>
                            <label><input type="checkbox" class="search-filter-check exclusive-check" name="sikko_kind" value="3"><span>失効全て</span></label>
                            <label><input type="checkbox" class="search-filter-check" name="shukya_kind" value="1" checked="checked"><span>出願却下を除く</span></label>
                        </div>
                    </td>
                </tr>
            </tbody></table>
        </div>
    </div>
</div>
    <table class="condition-table">
    <tbody><tr>
        <td class="condition-title">類似群コード</td>
        <td class="condition-help-icon">
            <span class="glyphicon glyphicon-question-sign type-help-icon" aria-hidden="true" onclick="app.toggleHelpRow('ruijigun');"></span>
        </td>
        <td class="condition-input form-inline" style="display: table;">
            <textarea name="similar_code" class="form-control text-one-line" maxlength="2000" style="width: 100%;"></textarea>
            <div style="width: 1%; display: table-cell; padding-left: 5px;">
                <button type="button" class="btn btn-default dictionary-btn" data-name="similar_code" data-type="106">補助</button>
            </div>
        </td>
    </tr>
    <tr style="display: none;">
        <td></td>
        <td></td>
        <td class="help help-ruijigun"></td>
    </tr>
    <tr>
        <td colspan="3" class="condition-spacer-row"></td>
    </tr>
    <tr>
        <td class="condition-title">国際分類</td>
        <td class="condition-help-icon">
            <span class="glyphicon glyphicon-question-sign type-help-icon" aria-hidden="true" onclick="app.toggleHelpRow('kokusaibunrui');"></span>
        </td>
        <td class="condition-input">
            <textarea name="international_class" class="form-control text-one-line" maxlength="2000"></textarea>
        </td>
    </tr>
    <tr style="display: none;">
        <td></td>
        <td></td>
        <td class="help help-kokusaibunrui"></td>
    </tr>
</tbody></table>

    <div class="exp" style="margin-top: 20px;">
        ※国際分類は類似群コードに展開して検索をおこないます。<br>
        ※類似群コードと国際分類を両方入力しない場合は、全類検索となります。<br>
        ※類似群コードと国際分類を両方入力した場合にはOR検索となります。<br>
        ※結果一覧または絞込みリストを表示した時点で課金となります。<br>
    </div>
</div>

</form>
<form action="javascript:;" class="search-condition count-form no-print-with-modal" id="count-form" style="display: none;">
    <div class="count-list" style="margin: 20px auto 0 auto; min-width: 1100px; display: table;">
        <div class="alert alert-danger error" style="display: none;"></div>

        <div class="row" style="margin-bottom: 20px;">
            <div class="col-md-6">
                <button type="button" class="btn btn-default merge-btn" disabled="disabled" data-type="or" data-loading-text="<i class='fa fa-spinner fa-spin'></i> ORマージ">ORマージ</button>
                <button type="button" class="btn btn-default merge-btn" disabled="disabled" data-type="and" data-loading-text="<i class='fa fa-spinner fa-spin'></i> ANDマージ">ANDマージ</button>
            </div>
            <div class="col-md-6 text-right">
                <button type="button" class="btn btn-default" id="add-shoko-btn">称呼追加</button>
                <button type="button" class="btn btn-default" id="change-search-condition-btn">検索条件変更</button>
            </div>
        </div>

        <table class="table-bordered" style="width: 100%; margin-bottom: 20px;">
            <thead>
            <tr>
                <th rowspan="2">No.</th>
                <th rowspan="2">結果<br>一覧</th>
                <th rowspan="2">
                    <label class="clickable toggle-all-merge-check-btn">
                        マージ<br>選択
                    </label>
                </th>
                <th rowspan="2" style="min-width: 300px;">称呼</th>
                <th colspan="3" style="border-bottom: 1px;">
                    類似
                    <button id="similar-search-btn" type="button" class="btn btn-sm btn-default" data-loading-text="<i class='fa fa-spinner fa-spin'></i> 検索">検索</button>
                </th>
                <th colspan="6" style="border-bottom: 1px;">同一</th>
            </tr>
            <tr>
                <th>
                    <label class="clickable toggle-all-similar-search-check-btn">
                        選択
                    </label>
                </th>
                <th>点数</th>
                <th>結果</th>
                <th>
                    <label class="clickable toggle-all-same-search-check-btn" data-number="0">
                        選択
                    </label>
                </th>
                <th>
                    <label class="clickable toggle-all-same-search-check-btn" data-number="1">
                        一致
                    </label>
                </th>
                <th>
                    <label class="clickable toggle-all-same-search-check-btn" data-number="2">
                        前方
                    </label>
                </th>
                <th>
                    <label class="clickable toggle-all-same-search-check-btn" data-number="3">
                        後方
                    </label>
                </th>
                <th>
                    <label class="clickable toggle-all-same-search-check-btn" data-number="4">
                        中間
                    </label>
                </th>
                <th>限定</th>
            </tr>
            </thead>
            <tbody id="count-list-body">
            <tr class="count-list-row">
                <td class="no"></td>
                <td>
                    <button type="button" class="btn btn-sm btn-warning list-btn" disabled="disabled" data-loading-text="<i class='fa fa-spinner fa-spin'></i> 表示">表示</button>
                </td>
                <td>
                    <input type="hidden" name="checked_for_merge[]" value="0" class="merge-hidden count-row-auto-index">
                    <input type="checkbox" class="merge-check" disabled="disabled">
                </td>
                <td class="title" style="text-align: left;"></td>
                <td>
                    <input type="hidden" name="checked_on_similar[]" value="1" class="similar-search-hidden count-row-auto-index">
                    <input type="checkbox" class="similar-search-check" checked="checked">
                </td>
                <td>
                    <input type="hidden" name="difference_point[]" class="difference-point-hidden count-row-auto-index" disabled="disabled">
                    <input type="text" name="difference_point[]" class="form-control difference-point count-row-auto-index" maxlength="3" style="width: 60px; text-align: right; margin: auto;">
                </td>
                <td style="text-align: right;">
                    <span class="similar-unsearch">未検索</span>
                    <span class="similar-searched similar-search-count" style="display: none;"></span>
                    <button type="button" class="btn btn-sm btn-warning similar-filter-condition-btn">絞込</button>
                </td>
                <td>
                    <input type="hidden" name="checked_on_same[][0]" value="1" class="same-search-hidden count-row-auto-index">
                    <input type="checkbox" class="same-search-check same-search-check0" checked="checked">
                </td>
                <td style="text-align: left;">
                    <div class="checkbox">
                        <input type="hidden" name="checked_on_same[][1]" value="1" class="same-search-hidden count-row-auto-index">
                        <label><input type="checkbox" class="same-search-check same-search-check1" checked="checked"> <span class="same-search-count1"></span></label>
                    </div>
                </td>
                <td style="text-align: left;">
                    <div class="checkbox">
                        <input type="hidden" name="checked_on_same[][2]" value="1" class="same-search-hidden count-row-auto-index">
                        <label><input type="checkbox" class="same-search-check same-search-check2" checked="checked"> <span class="same-search-count2"></span></label>
                    </div>
                </td>
                <td style="text-align: left;">
                    <div class="checkbox">
                        <input type="hidden" name="checked_on_same[][3]" value="1" class="same-search-hidden count-row-auto-index">
                        <label><input type="checkbox" class="same-search-check same-search-check3" checked="checked"> <span class="same-search-count3"></span></label>
                    </div>
                </td>
                <td style="text-align: left;">
                    <div class="checkbox">
                        <input type="hidden" name="checked_on_same[][4]" value="1" class="same-search-hidden count-row-auto-index">
                        <label><input type="checkbox" class="same-search-check same-search-check4" checked="checked"> <span class="same-search-count4"></span></label>
                    </div>
                </td>
                <td>
                    <button type="button" class="btn btn-sm btn-default limit-condition-btn">限定</button>
                </td>
            </tr>
            </tbody>
        </table>

        <div class="exp">
            ※同一レベルの検索結果が多い場合には、結果件数部分に「超過」と表示されます。<br>
            ※「点数」は「相違点数」の上限を意味します。類似検索は相違点数の上限を変更して再検索が可能です。<br>
            ※マージ選択をチェックしてORマージ/ANDマージのボタンを押すと、新たにマージ集合を作成して画面上に追加表示します。<br>
            ※一覧出力は選択チェックおよび件数横の個別チェックがついているもののみに限定できます。<br>
            ※結果一覧または絞込みリストを表示した時点で課金となります。<br>
            ※同一レベルの結果は商標単位で「一致」→「前方」→「後方」→「中間」の順に優先されます。<br>
        </div>
    </div>
</form>
<div id="search-result" class="search-result result2 split-view horizontal no-print-with-modal" style="display: none;">
    <div id="list"></div>
    <div class="gutter no-print" style="display: none;"></div>
    <div id="detail" class="no-print" style="display: none;"></div>
</div>
<div class="modal fade" tabindex="-1" role="dialog" id="dictionary-modal">
    <div class="modal-dialog" role="document" style="width: 840px;">
        <div class="modal-content"></div>
    </div>
</div>
<div class="modal fade" tabindex="-1" role="dialog" id="similar-filter-modal">
    <div class="modal-dialog" role="document" style="width: 500px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">絞込みリスト</h4>
            </div>
            <div class="modal-body" style="max-height: calc(100vh - 185px); overflow-y: auto;">
                <div class="radio-inline" style="display: flex; justify-content: space-around; margin-bottom: 5px;">
                    <label>
                        <input type="radio" name="filter_list_display" class="filter-list-display" value="all" checked=""> 全て表示
                    </label>
                    <label>
                        <input type="radio" name="filter_list_display" class="filter-list-display" value="checked"> チェック済みのみ表示
                    </label>
                </div>
                <table class="table table-hover filter-table" id="filter-shoko" data-name="shoko">
                    <thead>
                    <tr>
                        <th class="narrow-col"><input type="checkbox" name="shoko" class="filter-checkbox-all"></th>
                        <th class="narrow-col">No.</th>
                        <th class="narrow-col sortable-col" data-col="score" data-sort="asc">相違点数</th>
                        <th class="sortable-col" data-col="value">称呼</th>
                        <th class="narrow-col">件数</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><input type="checkbox" name="shoko" class="filter-checkbox"></td>
                        <td class="filter-no text-right"></td>
                        <td class="filter-score text-right"></td>
                        <td class="filter-value"></td>
                        <td class="filter-count text-right"></td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">閉じる</button>
                <button type="button" class="btn btn-primary" id="filter-btn" style="width: 150px;" data-loading-text="<i class='fa fa-spinner fa-spin'></i> 絞込み">絞込み</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" tabindex="-1" role="dialog" id="pdf-download-modal">
    <div class="modal-dialog" role="document" style="width: 300px;">
        <div class="modal-content">
            <form id="pdf-download-form">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                    <h4 class="modal-title">PDFダウンロード</h4>
                </div>
                <div class="modal-body">
                    <div id="pdf-download-options-for-table">
                        <div class="radio">
                            <label><input type="radio" name="list_type" value="simple" id="list-type-simple">簡易</label>
                            <label><input type="radio" name="list_type" value="detail">詳細</label>
                        </div>
                        <div class="checkbox">
                            <label><input type="checkbox" name="output_image" value="1">イメージ</label>
                        </div>
                    </div>
                                            <div class="checkbox">
                            <label><input type="checkbox" name="output_condition" value="1">検索条件</label>
                        </div>
                                                                <div class="checkbox">
                            <label><input type="checkbox" name="output_shoko" value="1" checked="checked">称呼</label>
                        </div>
                                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">閉じる</button>
                    <button type="button" class="btn btn-primary download-btn pdf-download-btn" onclick="app.downloadList('pdf');">ダウンロード</button>
                </div>
            </form>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<div class="modal fade" tabindex="-1" role="dialog" id="condition-save-modal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <form id="condition-save-form">
                <input type="hidden" name="condition_id" id="condition-id">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                    <h4 class="modal-title">条件設定</h4>
                </div>
                <div class="modal-body">
                    <p class="pull-left">現在指定されている条件を以下の名前で保存します</p>
                    <input type="text" name="condition_name" class="form-control" id="condition-save-name" placeholder="条件名を入力してください">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary pull-left condition-save-new-btn">新規追加</button>
                    <button type="button" class="btn btn-primary condition-save-btn condition-create-btn">新規保存</button>
                    <button type="button" class="btn btn-primary condition-save-btn condition-update-btn">上書保存</button>
                </div>
                <div class="modal-body condition-save-modal-list-item" style="max-height: calc(100vh - 340px); overflow-y: auto;">
                    <p>設定済み条件の並べ替え、初期表示設定、削除ができます</p>
                    <table class="table table-striped" style="margin-bottom: 0;">
                        <tbody class="condition-sort-list"></tbody>
                    </table>
                </div>
                <div class="modal-footer condition-save-modal-list-item">
                    <button type="button" class="btn btn-default" data-dismiss="modal">閉じる</button>
                    <button type="button" class="btn btn-primary condition-list-save-btn">設定一覧保存</button>
                </div>
            </form>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<div class="modal fade" tabindex="-1" role="dialog" id="limit-condition-modal">
    <div class="modal-dialog" role="document" style="width: 400px;">
        <form action="javascript:;" id="limit-form">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                    <h4 class="modal-title">限定指定</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-danger error limit-modal-error" style="display: none;"></div>
                    <table class="table">
                        <thead>
                        <tr>
                            <th colspan="2">同一レベルの限定</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td class="text-center" style="vertical-align: middle">
                                <span class="radio">
                                    <label><input type="radio" name="level" value="1">発音同一</label>
                                </span>
                            </td>
                            <td class="text-center" style="vertical-align: middle">
                                <div class="radio">
                                    <label><input type="radio" name="level" value="2">表記同一</label>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <table class="table" style="margin-bottom: 10px;">
                        <thead>
                        <tr>
                            <th>称呼長の限定</th>
                            <th class="text-center" style="font-weight: normal;">範囲指定</th>
                            <th class="text-center" style="font-weight: normal;">音数指定</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td class="text-center" style="vertical-align: middle">一致</td>
                            <td class="form-inline text-center">
                                <input type="text" name="llp[1]" class="form-control range-input" maxlength="3" style="width: 50px;">
                                〜
                                <input type="text" name="ulp[1]" class="form-control range-input" maxlength="3" style="width: 50px;">
                            </td>
                            <td class="form-inline text-center">
                                <input type="text" name="sp[1]" class="form-control count-input" maxlength="3" style="width: 50px;">
                            </td>
                        </tr>
                        <tr>
                            <td class="text-center" style="vertical-align: middle">前方</td>
                            <td class="form-inline text-center">
                                <input type="text" name="llp[2]" class="form-control range-input" maxlength="3" style="width: 50px;">
                                〜
                                <input type="text" name="ulp[2]" class="form-control range-input" maxlength="3" style="width: 50px;">
                            </td>
                            <td class="form-inline text-center">
                                <input type="text" name="sp[2]" class="form-control count-input" maxlength="3" style="width: 50px;">
                            </td>
                        </tr>
                        <tr>
                            <td class="text-center" style="vertical-align: middle">後方</td>
                            <td class="form-inline text-center">
                                <input type="text" name="llp[3]" class="form-control range-input" maxlength="3" style="width: 50px;">
                                〜
                                <input type="text" name="ulp[3]" class="form-control range-input" maxlength="3" style="width: 50px;">
                            </td>
                            <td class="form-inline text-center">
                                <input type="text" name="sp[3]" class="form-control count-input" maxlength="3" style="width: 50px;">
                            </td>
                        </tr>
                        <tr>
                            <td class="text-center" style="vertical-align: middle">中間</td>
                            <td class="form-inline text-center">
                                <input type="text" name="llp[4]" class="form-control range-input" maxlength="3" style="width: 50px;">
                                〜
                                <input type="text" name="ulp[4]" class="form-control range-input" maxlength="3" style="width: 50px;">
                            </td>
                            <td class="form-inline text-center">
                                <input type="text" name="sp[4]" class="form-control count-input" maxlength="3" style="width: 50px;">
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    ※範囲指定または音数指定のどちらかを指定できます
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">閉じる</button>
                    <button type="button" class="btn btn-primary" id="limit-btn" style="width: 150px;" data-loading-text="<i class='fa fa-spinner fa-spin'></i> 限定">限定</button>
                </div>
            </div>
        </form>
    </div>
</div>
<style class="no-print-with-modal">
.detail th {
    white-space: nowrap;
    vertical-align: top;
    font-weight: normal;
    padding-right: 15px;
}
.detail td {
    padding-bottom: 5px;
}
.page-title {
    padding-bottom: 10px;
}

th {
    white-space: nowrap;
}

.header-condition label {
    margin: 0 8px;
    font-size: 110%;
}

.form-horizontal label {
    font-weight: normal;
}

.count-list table>tbody>tr>td,
.count-list table>thead>tr>th {
    vertical-align: middle;
    text-align: center;
    width: 1px;
    white-space: nowrap;
}

.count-list .border-left {
    border-left: 2px solid #dddddd;
}
</style>
<script class="no-print-with-modal">
    var countList = {};

    countList.toggleAllMergeCheck = function() {
        var checked = false;
        var mergeChecks = $(".count-list .merge-check");
        mergeChecks.each(function() {
            if (!$(this).prop("disabled") &&
                !$(this).prop("checked")) {
                checked = true;
            }
        });
        mergeChecks.each(function() {
            if (!$(this).prop("disabled")) {
                $(this).prop("checked", checked);
            }
        });

        countList.updateMergeCheckRelatedObjects();
    };

    countList.toggleAllSimilarSearchCheck = function() {
        var checked = false;
        var similarSearchChecks = $(".count-list .similar-search-check");
        similarSearchChecks.each(function() {
            if (!$(this).prop("checked")) {
                checked = true;
            }
        });
        similarSearchChecks.prop("checked", checked);

        countList.updateSimilarSearchCheckRelatedObjects();
    };

    countList.toggleAllSameSearchCheck = function() {
        var number = $(this).attr("data-number")
        var checked = false;
        var sameSearchChecks;
        if (number > 0) {
            sameSearchChecks = $(".count-list .same-search-check" + number);
        } else {
            sameSearchChecks = $(".count-list .same-search-check");
        }
        sameSearchChecks.each(function() {
            if (!$(this).prop("checked")) {
                checked = true;
            }
        });
        sameSearchChecks.prop("checked", checked);

        countList.updateSameSearchCheckRelatedObjects();
    };

    countList.setSameSearchCountFromItem = function(item, obj) {
        if (item.same_search_desc.searched) {
            console.log(item);
            var sameSearchCheck0Disabled = true;
            for (var mode = 1; mode <= 4; mode++) {
                var unlimitedCount = item.same_search_desc.key_count_map[mode];
                if (item.same_search_desc.too_much_records_map &&
                    item.same_search_desc.too_much_records_map[mode]) {
                    unlimitedCount = "超過";
                }
                var isLimited = false;
                if (item.same_search_desc.is_limited) {
                    isLimited = true;
                }
                var limitedCount = item.same_search_desc.limited_key_count_map[mode];
                var sameSearchCheckDisabled = false;
                if (limitedCount == 0) {
                    sameSearchCheckDisabled = true;
                } else {
                    sameSearchCheck0Disabled = false;
                }
                if (item.merge_desc) {
                    sameSearchCheckDisabled = true;
                }
                if (item.same_search_desc.too_much_limited_records_map &&
                    item.same_search_desc.too_much_limited_records_map[mode]) {
                    limitedCount = "超過";
                }
                var count = limitedCount;
                if (isLimited) {
                    count = limitedCount + "/" + unlimitedCount;
                }
                var sameSearchCount = obj.find(".same-search-count" + mode);
                var sameSearchCheck = obj.find(".same-search-check" + mode);
                sameSearchCount.html(count);
                sameSearchCheck.prop("disabled", sameSearchCheckDisabled);
                if (sameSearchCheckDisabled) {
                    sameSearchCheck.addClass("default-disabled");
                    sameSearchCheck.prop("checked", false).attr("checked", false);
                } else {
                    sameSearchCheck.removeClass("default-disabled");
                    sameSearchCheck.prop("checked", true).attr("checked", true);
                }
            }
            obj.find(".same-search-check0").prop("disabled", sameSearchCheck0Disabled);
            if (sameSearchCheck0Disabled) {
                obj.find(".same-search-check0").prop("checked", false).attr("checked", false);
            }
        }
        countList.updateSameSearchHiddenValue();
    };

    countList.setSimilarSearchCountFromItem = function(item, obj) {
        if (item.similar_search_desc.searched) {
            var differencePoint = item.similar_search_desc.difference_point;
            var unlimitedCount = item.similar_search_desc.key_count;
            var limitedCount = item.similar_search_desc.limited_key_count;
            var count = limitedCount;
            var similarSearchChecked = true;
            var similarSearchFilterDisabled = false;
            if (limitedCount == 0) {
                similarSearchChecked = false;
            }
            if (unlimitedCount == 0) {
                similarSearchFilterDisabled = true;
            }
            if (limitedCount != unlimitedCount) {
                count = limitedCount + "/" + unlimitedCount;
            }
            obj.find(".difference-point").val(differencePoint);
            obj.find(".similar-search-count").html(count);
            obj.find(".similar-search-check").attr("data-count", limitedCount);
            obj.find(".similar-search-check").prop("checked", similarSearchChecked);
            obj.find(".similar-search-hidden").val(similarSearchChecked ? "1" : "0");
            obj.find(".similar-filter-condition-btn").prop("disabled", similarSearchFilterDisabled);
            obj.find(".similar-unsearch").hide();
            obj.find(".similar-searched").show();
        }
    };

    countList.setListBtnClickEvent = function(row) {
        row.find(".list-btn").click(function() {
            app.vars.clickedListBtn = $(this);
            app.vars.clickedListBtn.button("loading");
            var row = app.vars.clickedListBtn.closest(".count-list-row");
            var rowIndex = row.attr("data-index");
            app.saveListData(rowIndex, function() {
                app.updateList(null, function() {
                    app.hideSearchCondition();
                    $(".count-form").hide();
                    countList.chargeRow(row);
                    countList.updateAllRowsChargeStatus();
                });
            });
        });
    };

    countList.isEmptyRow = function(row) {
        if (row.find(".similar-search-check").attr("data-count") == 0 &&
            row.find(".same-search-check0").prop("disabled")) {
            return true;
        }
        return false;
    };

    countList.isMergedRow = function(row) {
        return row.hasClass("merged");
    };

    countList.isAllParentRowSimilarSearched = function(row) {
        if (!countList.isMergedRow(row)) {
            return false;
        }

        var rowIndex = row.attr("data-index");
        var searchedItem = app.vars.searchedItems[rowIndex];
        var srcLines = searchedItem.merge_desc.similar_search_src_lines;
        var charged = true;

        // すべての親の行が課金済みかどうかをチェック
        var rows = $(".count-list-row");
        for (var srcRowIndex in srcLines) {
            var parentRowIndex = srcLines[srcRowIndex];
            var parentRow = rows.eq(parentRowIndex);
            if (!countList.isSimilarChargedRow(parentRow)) {
                charged = false;
                break;
            }
        }

        return charged;
    };

    countList.isAllParentRowSameCharged = function(row) {
        if (!countList.isMergedRow(row)) {
            return false;
        }

        var rowIndex = row.attr("data-index");
        var searchedItem = app.vars.searchedItems[rowIndex];
        var srcLines = searchedItem.merge_desc.same_search_src_lines;
        var charged = true;

        // すべての親の行が課金済みかどうかをチェック
        var rows = $(".count-list-row");
        for (var srcRowIndex in srcLines) {
            var parentRowIndex = srcLines[srcRowIndex];
            var parentRow = rows.eq(parentRowIndex);
            if (!countList.isSameChargedRow(parentRow)) {
                charged = false;
                break;
            }
        }

        return charged;
    };

    countList.hasSimilarChargedMergeRow = function(parentRow) {
        var parentRowIndex = parentRow.attr("data-index");
        var hasChargedMergeRow = false;

        $(".count-list-row").each(function() {
            var row = $(this);
            var rowIndex = row.attr("data-index");
            if (rowIndex == parentRowIndex ||
                !countList.isMergedRow(row) ||
                !countList.isSimilarChargedRow(row)) {
                return;
            }

            // マージした行が課金されているかどうか
            var searchedItem = app.vars.searchedItems[rowIndex];
            var srcLines = searchedItem.merge_desc.similar_search_src_lines;
            for (var srcRowIndex in srcLines) {
                if (srcRowIndex == parentRowIndex) {
                    hasChargedMergeRow = true;
                    return;
                }
            }

            if (countList.isMergedRow(parentRow)) {
                // 同じ親をもつマージ行が課金されているかどうか
                var parentSearchedItem = app.vars.searchedItems[parentRowIndex];
                var parentSrcLines = parentSearchedItem.merge_desc.similar_search_src_lines;
                for (var parentSrcRowIndex in parentSrcLines) {
                    if (!(parentSrcRowIndex in srcLines)) {
                        return;
                    }
                }
                hasChargedMergeRow = true;
            }
        });

        return hasChargedMergeRow;
    };

    countList.hasSameChargedMergeRow = function(parentRow) {
        var parentRowIndex = parentRow.attr("data-index");
        var hasChargedMergeRow = false;

        $(".count-list-row").each(function() {
            var row = $(this);
            var rowIndex = row.attr("data-index");
            if (rowIndex == parentRowIndex ||
                !countList.isMergedRow(row) ||
                !countList.isSameChargedRow(row)) {
                return;
            }

            // マージした行が課金されているかどうか
            var searchedItem = app.vars.searchedItems[rowIndex];
            var srcLines = searchedItem.merge_desc.same_search_src_lines;
            for (var srcRowIndex in srcLines) {
                if (srcRowIndex == parentRowIndex) {
                    hasChargedMergeRow = true;
                    return;
                }
            }

            if (countList.isMergedRow(parentRow)) {
                // 同じ親をもつマージ行が課金されているかどうか
                var parentSearchedItem = app.vars.searchedItems[parentRowIndex];
                var parentSrcLines = parentSearchedItem.merge_desc.same_search_src_lines;
                for (var parentSrcRowIndex in parentSrcLines) {
                    if (!(parentSrcRowIndex in srcLines)) {
                        return;
                    }
                }
                hasChargedMergeRow = true;
            }
        });

        return hasChargedMergeRow;
    };

    countList.isSimilarChargedRow = function(row) {
        return row.hasClass("similar-charged");
    };

    countList.isSameChargedRow = function(row) {
        return row.hasClass("same-charged");
    };

    countList.isSimilarSearchCheckedRow = function(row) {
        return row.find(".similar-search-check").prop("checked");
    };

    countList.isSameSearch0CheckedRow = function(row) {
        return row.find(".same-search-check0").prop("checked");
    };

    countList.isSimilarSearchDisabledRow = function(row) {
        return row.find(".similar-search-check").prop("disabled");
    };

    countList.isSameSearch0DisabledRow = function(row) {
        return row.find(".same-search-check0").prop("disabled");
    };

    countList.isSimilarSearchEnabledAndCheckedRow = function(row) {
        var similarSearchCheck = row.find(".similar-search-check");
        return !similarSearchCheck.prop("disabled") &&
            similarSearchCheck.prop("checked") &&
            similarSearchCheck.attr("data-count") != 0;
    };

    countList.isSameSearch0EnabledAndCheckedRow = function(row) {
        var sameSearchCheck0 = row.find(".same-search-check0");
        return !sameSearchCheck0.prop("disabled") &&
            sameSearchCheck0.prop("checked")
    };

    countList.chargeSimilarSearch = function(row) {
        row.addClass("similar-charged");
    };

    countList.chargeSameSearch = function(row) {
        row.addClass("same-charged");
    };

    countList.resetAllChargeStatus = function() {
        $(".count-list-row").removeClass("similar-charged").removeClass("same-charged");
    };

    countList.chargeRow = function(row) {
        if (countList.isSimilarSearchEnabledAndCheckedRow(row) ||
            countList.isSimilarSearchDisabledRow(row)) {
            countList.chargeSimilarSearch(row);
        }
        if (countList.isSameSearch0EnabledAndCheckedRow(row) ||
            countList.isSameSearch0DisabledRow(row)) {
            countList.chargeSameSearch(row);
        }
    };

    countList.updateRowChargeStatus = function(row) {
        var listBtnCharged = false;
        var isSimilarCharged = countList.isSimilarChargedRow(row) ||
            countList.hasSimilarChargedMergeRow(row) ||
            countList.isAllParentRowSimilarSearched(row);
        var isSameCharged = countList.isSameChargedRow(row) ||
            countList.hasSameChargedMergeRow(row) ||
            countList.isAllParentRowSameCharged(row);

        if (isSimilarCharged && isSameCharged) {
            listBtnCharged = true;
        } else if (isSimilarCharged) {
            if (!countList.isSameSearch0CheckedRow(row)) {
                listBtnCharged = true;
            }
        } else if (isSameCharged) {
            if (!countList.isSimilarSearchCheckedRow(row)) {
                listBtnCharged = true;
            }
        }

        if (countList.isEmptyRow(row)) {
            listBtnCharged = true;
            isSimilarCharged = true;
        }

        if (isSimilarCharged) {
            app.chargeListBtn(row.find(".similar-filter-condition-btn"));
            countList.chargeSimilarSearch(row);
        }

        if (isSameCharged) {
            countList.chargeSameSearch(row);
        }

        var listBtn = row.find(".list-btn");
        if (listBtnCharged) {
            app.chargeListBtn(listBtn);
        } else {
            app.resetListBtn(listBtn);
        }
    };

    countList.updateAllRowsChargeStatus = function() {
        $(".count-list-row").each(function() {
            var row = $(this);
            countList.updateRowChargeStatus(row);
        });
    };

    countList.setMargeCheckClickEvent = function(row) {
        row.find(".merge-check").click(countList.updateMergeCheckRelatedObjects);
    };

    countList.setSimilarSearchCheckClickEvent = function(row) {
        row.find(".similar-search-check").click(countList.updateSimilarSearchCheckRelatedObjects);
    };

    countList.setSameSearchCheckClickEvent = function(row) {
        row.find(".same-search-check").click(countList.updateSameSearchCheckRelatedObjects);
    };

    countList.setSimilarFilterConditionBtnClickEvent = function(row) {
        row.find(".similar-filter-condition-btn").click(function() {
            var row = $(this).closest("tr");
            var index = row.attr("data-index");
            app.vars.countListRowIndex = index;
            app.showSimilarFilterCondition();
        });
    };

    countList.setLimitConditionBtnClickEvent = function(row) {
        row.find(".limit-condition-btn").click(function() {
            var index = $(this).closest("tr").attr("data-index");
            app.vars.countListRowIndex = index;
            app.showLimitCondition(index);
        });
    };

    countList.getCountListChargeStatuses = function() {
        var chargeStatuses = {};
        $(".count-list-row").each(function() {
            var row = $(this);
            var title = row.find(".title").html();
            if (title) {
                chargeStatuses[title] = {
                    "similar": countList.isSimilarChargedRow(row),
                    "same": countList.isSameChargedRow(row)
                };
            }
        });
        return chargeStatuses;
    };

    countList.setCountListFromItems = function(items) {
        if (!app.vars.countListTemplate) {
            app.vars.countListTemplate = $("#count-list-body").html();
        }

        var chargeStatuses = countList.getCountListChargeStatuses();

        if (app.vars.clearCountList) {
            $("#count-list-body").empty();
            app.vars.clearCountList = false;
        }

        // 追加済みの行数
        var rows = $("#count-list-body .count-list-row").length;

        for (var i in items) {
            var no = parseInt(i) + 1;
            if (no <= rows) {
                // 追加済みの行
                continue;
            }

            var item = items[i];
            var workspace = $("#workspace");
            workspace.html(app.vars.countListTemplate);
            var row = workspace.find(".count-list-row");
            row.attr("data-index", i);
            workspace.find(".no").html(no);
            workspace.find(".title").html(item.title);
            countList.setSimilarSearchCountFromItem(item, workspace);
            countList.setSameSearchCountFromItem(item, workspace);

            // フォームパラメータの行インデックスをセット
            workspace.find(".count-row-auto-index").each(function() {
                var name = $(this).attr("name");
                name = name.replace('[]', '[' + i + ']');
                $(this).attr("name", name);
            });

            if (item.merge_desc) {
                // マージ行
                row.addClass("merged");
                if (workspace.find(".similar-filter-condition-btn").attr("disabled")) {
                    workspace.find(".similar-search-check").attr("disabled", true).attr("checked", false);
                }
                workspace.find(".difference-point").attr("disabled", true);
                workspace.find(".difference-point-hidden").attr("disabled", false);
                workspace.find(".same-search-check1").remove();
                workspace.find(".same-search-check2").remove();
                workspace.find(".same-search-check3").remove();
                workspace.find(".same-search-check4").remove();
                workspace.find(".limit-condition-btn").attr("disabled", true);
            } else {
                workspace.find(".difference-point").attr("value", item.similar_search_desc.difference_point);
            }

            // 課金状態を復元
            if (chargeStatuses[item.title]) {
                var chargeStatus = chargeStatuses[item.title];
                if (chargeStatus.similar) {
                    countList.chargeSimilarSearch(row);
                }
                if (chargeStatus.same) {
                    countList.chargeSameSearch(row);
                }
            }

            $("#count-list-body").append(workspace.html());
            $("#workspace").empty();

            var row = $("#count-list-body .count-list-row").last();

            countList.setListBtnClickEvent(row);
            countList.setMargeCheckClickEvent(row);
            countList.setSimilarSearchCheckClickEvent(row);
            countList.setSameSearchCheckClickEvent(row);
            countList.setSimilarFilterConditionBtnClickEvent(row);
            countList.setLimitConditionBtnClickEvent(row);
        }

        countList.updateAllListBtnAndMergeChecks();
        countList.updateAllRowsChargeStatus();
    };

    countList.removeCountListRowIfNotExists = function(items) {
        $("#count-list-body .count-list-row").each(function() {
            var exists = false;
            var row = $(this);

            // タイトルが同じ行を探す
            for (var i in items) {
                var item = items[i];
                if (row.find(".title").html() == item.title) {
                    exists = true;
                }
            }

            if (!exists) {
                row.addClass('not-exists-row');
            }
        });

        if ($("#count-list-body .not-exists-row").length > 0) {
            $("#count-list-body .not-exists-row").remove();
            countList.updateCountListRowIndex();
        }
    };

    countList.updateCountListRowIndex = function() {
        $("#count-list-body .count-list-row").each(function(i) {
            var row = $(this);
            var no = parseInt(i) + 1;
            row.attr("data-index", i);
            row.find(".no").html(no);

            // フォームパラメータの行インデックスをセット
            row.find(".count-row-auto-index").each(function() {
                var name = $(this).attr("name");
                name = name.replace(/\[\d?\]/, '[' + i + ']');
                $(this).attr("name", name);
            });
        });
    };

    countList.updateSameSearchCheck0 = function(row) {
        var checked = false;
        for (var i=1; i<=4; i++) {
            var sameSearchCheck = row.find(".same-search-check" + i);
            if (!sameSearchCheck.prop("disabled") &&
                sameSearchCheck.prop("checked")) {
                checked = true;
            }
        }
        row.find(".same-search-check0").prop("checked", checked);
    };

    countList.updateSameSearchCheckByMergeCheck = function(row) {
        var mergeCheck = row.find(".merge-check");
        var sameSearchCheckDisabled = mergeCheck.prop("checked") && !mergeCheck.prop("disabled");
        for (var i=1; i<=4; i++) {
            var sameSearchCheck = row.find(".same-search-check" + i);
            if (!sameSearchCheck.hasClass("default-disabled")) {
                sameSearchCheck.prop("disabled", sameSearchCheckDisabled);
            }
        }
    };

    countList.updateAllSameSearchChecksByMergeCheck = function() {
        var rows = $(".count-list-row");

        rows.each(function() {
            var row = $(this);
            countList.updateSameSearchCheckByMergeCheck(row);
        });
    };

    countList.updateListBtn = function(row) {
        var disabled = true;

        // 類似検索済みでチェックあり
        if (countList.isSimilarSearchEnabledAndCheckedRow(row) &&
            row.find(".similar-search-count").html() != "") {
            disabled = false;
        }

        if (disabled) {
            if (countList.isMergedRow(row)) {
                // 同一選択チェックあり
                if (countList.isSameSearch0EnabledAndCheckedRow(row)) {
                    disabled = false;
                }
            } else {
                // 同一個別チェック（一致、前方、後方、中間）あり
                row.find(".same-search-check").each(function() {
                    var sameSearchCheck = $(this);
                    if (!sameSearchCheck.hasClass("same-search-check0")) {
                        if (!sameSearchCheck.prop("disabled") &&
                            sameSearchCheck.prop("checked")) {
                            disabled = false;
                        }
                    }
                });
            }
        }

        row.find(".list-btn").prop("disabled", disabled);
    };

    countList.updateMergeCheck = function(row) {
        var disabled = true;

        // 類似検索済みでチェックあり
        if (countList.isSimilarSearchEnabledAndCheckedRow(row) &&
            row.find(".similar-search-count").html() != "") {
            disabled = false;
        }

        if (disabled) {
            // 同一チェックあり
            if (countList.isSameSearch0EnabledAndCheckedRow(row)) {
                disabled = false;
            }
        }

        row.find(".merge-check").prop("disabled", disabled);

        if (countList.isEmptyRow(row)) {
            row.find(".merge-check").prop("checked", false);
        }

        countList.updateSameSearchCheckByMergeCheck(row);
    };

    countList.updateListBtnAndMergeCheck = function(row) {
        countList.updateMergeCheck(row);
        countList.updateListBtn(row);
        countList.updateRowChargeStatus(row);
        countList.updateMergeBtn();
    };

    countList.updateAllListBtnAndMergeChecks = function() {
        var rows = $(".count-list-row");
        rows.each(function() {
            var row = $(this);
            countList.updateListBtnAndMergeCheck(row);
        });
    };

    countList.updateMergeBtn = function() {
        var rows = $(".count-list-row");
        var btnDisabled = true;
        var checkedCount = 0;
        rows.find(".merge-check").each(function() {
            if (!$(this).prop("disabled") &&
                $(this).prop("checked")) {
                checkedCount++;
            }
        });
        if (checkedCount >= 2) {
            btnDisabled = false;
        }
        $(".merge-btn").prop("disabled", btnDisabled);
    };

    countList.updateSimilarSearchBtn = function() {
        var rows = $(".count-list-row");
        var btnDisabled = true;
        rows.find(".similar-search-check").each(function() {
            if (!$(this).prop("disabled") &&
                $(this).prop("checked")) {
                btnDisabled = false;
            }
        });
        $("#similar-search-btn").prop("disabled", btnDisabled);
    };

    countList.updateMergeHiddenValue = function() {
        var rows = $(".count-list-row");
        rows.find(".merge-check").each(function() {
            var value = "0";
            if ($(this).prop("checked")) {
                value = "1";
            }
            $(this).closest("td").find(".merge-hidden").val(value);
        });
    };

    countList.updateSimilarSearchHiddenValue = function() {
        var rows = $(".count-list-row");
        rows.find(".similar-search-check").each(function() {
            var value = "0";
            if ($(this).prop("checked")) {
                value = "1";
            }
            $(this).closest("td").find(".similar-search-hidden").val(value);
        });
    };

    countList.updateSameSearchHiddenValue = function() {
        var rows = $(".count-list-row");
        rows.find(".same-search-check").each(function() {
            var value = "0";
            if ($(this).prop("checked")) {
                value = "1";
            }
            $(this).closest("td").find(".same-search-hidden").val(value);
        });
    };

    countList.updateMergeCheckRelatedObjects = function() {
        countList.updateMergeHiddenValue();
        countList.updateMergeBtn();
        countList.updateAllSameSearchChecksByMergeCheck();
        countList.updateAllListBtnAndMergeChecks();
    };

    countList.updateSimilarSearchCheckRelatedObjects = function() {
        countList.updateSimilarSearchHiddenValue();
        countList.updateSimilarSearchBtn();
        countList.updateMergeCheckRelatedObjects();
    };

    countList.updateSameSearchCheckRelatedObjects = function() {
        var checked = $(this).prop("checked");
        var row = $(this).closest("tr");

        if ($(this).hasClass("same-search-check0")) {
            // 行の選択チェック
            row.find(".same-search-check").prop("checked", checked);
        } else {
            countList.updateSameSearchCheck0(row);
        }

        countList.updateSameSearchHiddenValue();
        countList.updateMergeCheckRelatedObjects();
    };
</script>

<script class="no-print-with-modal">
    app.serviceName = 'ruijipro';
    app.vars.searchId = '79dc2a7ff8eb9dd7a9f400bd90e5afa4';

    $(function() {
        // ワークスペース追加（HTML加工に利用）
        $("body").append('<div id="workspace" style="display: none;"></div>');

        $(".condition-clear-btn").click(function() {
            if (confirm("検索条件をクリアしますか？")) {
                app.clearCondition();
            }
        });

        // 辞書ボタンクリック
        $(".dictionary-btn").click(app.showDictionaryModal);

        // 辞書検索ボタン
        $(".shoko-dictionary-search-btn").click(app.searchDictionary103);

        // 称呼をセットボタン
        $(".set-shoko-dictionary-item-btn").click(app.setShokoDictionaryItem);

        // 検索実行ボタン
        $("#search-btn").click(function() {
            // 検索条件変更フォームへ入力内容をセット
            $("#change-search-condition-form [name=sonzoku_kind]").val([$("#search-condition-form [name=sonzoku_kind]:checked").val()]);
            $("#change-search-condition-form [name=sikko_kind]").val([$("#search-condition-form [name=sikko_kind]:checked").val()]);
            $("#change-search-condition-form [name=shukya_kind]").val([$("#search-condition-form [name=shukya_kind]:checked").val()]);
            app.setSearchFilterLabel("change-search-condition-form");
            $("#change-search-condition-form [name=cb_1]").val([$("#search-condition-form [name=cb_1]:checked").val()]);
            $("#change-search-condition-form [name=similar_code]").val($("#search-condition-form [name=similar_code]").val());
            $("#change-search-condition-form [name=international_class]").val($("#search-condition-form [name=international_class]").val());
            app.vars.countListLastNo = 0;
            app.vars.clearCountList = true;
            app.vars.callSimilarSearch = true;
            app.sameSearch("search-condition-form");
        });

        // 検索条件変更実行ボタン
        $("#change-search-btn").click(function() {
            // 検索条件フォームへ入力内容をセット
            $("#search-condition-form [name=sonzoku_kind]").val([$("#change-search-condition-form [name=sonzoku_kind]:checked").val()]);
            $("#search-condition-form [name=sikko_kind]").val([$("#change-search-condition-form [name=sikko_kind]:checked").val()]);
            $("#search-condition-form [name=shukya_kind]").val([$("#change-search-condition-form [name=shukya_kind]:checked").val()]);
            app.setSearchFilterLabel("search-condition-form");
            $("#search-condition-form [name=cb_1]").val([$("#change-search-condition-form [name=cb_1]:checked").val()]);
            $("#search-condition-form [name=similar_code]").val($("#change-search-condition-form [name=similar_code]").val());
            $("#search-condition-form [name=international_class]").val($("#change-search-condition-form [name=international_class]").val());
            app.vars.clearCountList = true;
            app.vars.callSimilarSearch = true;
            app.sameSearch("change-search-condition-form");
        });

        // 称呼追加実行ボタン
        $("#add-shoko-search-btn").click(function() {
            // 検索条件フォームへ入力内容をセット
            var list1 = $("#search-condition-form [name=names]").val().split(/\r?\n/);
            var list2 = $("#add-shoko-search-form [name=names]").val().split(/\r?\n/);
            var list = list1.concat(list2);
            list = list.filter((element, index) => list.indexOf(element) === index)
            $("#search-condition-form [name=names]").val(list.join("\r\n"));
            app.vars.callSimilarSearch = true;
            app.vars.similarSearchFristIndex = $("#count-list-body .count-list-row").length;
            app.sameSearch("add-shoko-search-form");
        });

        // 類似検索実行
        $("#similar-search-btn").click(app.similarSearch);

        // 類似絞込実行
        $("#filter-btn").click(app.similarFilter);

        // 限定実行
        $("#limit-btn").click(app.limit);

        // 検索条件に戻るボタン
        $("#search-condition-btn").click(app.showSearchCondition);

        // 称呼追加ボタン
        $("#add-shoko-btn").click(app.showAddShokoForm);

        // 検索条件変更ボタン
        $("#change-search-condition-btn").click(app.showChangeSearchConditionForm);

        // 件数リストの戻るボタン
        $("#count-list-back-btn").click(app.showSearchConditionFromCountList);

        // マージボタン
        $(".merge-btn").click(app.merge);

        // マージチェック全選択ボタン
        $(".toggle-all-merge-check-btn").click(countList.toggleAllMergeCheck);

        // 類似検索チェック全選択ボタン
        $(".toggle-all-similar-search-check-btn").click(countList.toggleAllSimilarSearchCheck);

        // 同一検索チェック全選択ボタン
        $(".toggle-all-same-search-check-btn").click(countList.toggleAllSameSearchCheck);

        // 検索キャンセルボタン
        $(".cancel-search-btn").click(app.showCountList);

        // 限定指定　範囲指定入力で音数指定クリア
        $("#limit-condition-modal .range-input").change(function() {
            $(this).closest("tr").find(".count-input").val("");
        });

        // 限定指定　音数指定入力で範囲指定クリア
        $("#limit-condition-modal .count-input").change(function() {
            $(this).closest("tr").find(".range-input").val("");
        });

        // 詳細タブ
        $(".detail-tabs a").click(function() {
            $(".detail-tabs li").removeClass("active");
            $(this).parent().addClass("active");

            $(".detail").hide();
            $("." + $(this).attr("data-action")).show();
        });

        // 条件リスト読み込み
        app.loadSavedConditions('default');

        app.setSearchFilterLabel("search-condition-form");
    });

    // 条件クリア
    app.clearCondition = function() {
        var currentConditionId = $("#saved-condition").val();
        if (currentConditionId !== '') {
            app.setSavedConditionToFormById(currentConditionId);
        } else {
            app.initExtraCondition();
            app.setSearchFilterLabel("search-condition-form");
            app.setSearchFilterLabel("change-search-condition-form");
            $("textarea[name=names]").val("");
            $("textarea[name=similar_code]").val("");
            $("textarea[name=international_class]").val("");
            $(".dictionary-search-shohyo").val("");
            $(".shoko-dictionary-search-result").empty();
        }
        $(".search-result-item").hide();
        app.clearError();
    };

    // 辞書モーダル表示
    app.showDictionaryModal = function() {
        var name = $(this).attr("data-name");
        var type = $(this).attr("data-type");
        var conditionTable = $(this).closest(".condition-table");

        $(".dictionary-input").removeClass("dictionary-input");
        conditionTable.find("[name=" + name + "]").addClass("dictionary-input");

        var params = 'service_name=' + app.serviceName +
                '&search_id=' + app.vars.searchId;

        $("#dictionary-modal .modal-content").load("/dictionary/modal" + type, params, function() {
            $("#dictionary-modal").modal();
        });
    };

    // 辞書モーダル閉じる
    app.hideDictionaryModal = function() {
        $("#dictionary-modal").modal('hide');
    };

    app.searchDictionary = function(type) {
        $(".dictionary-search-btn").button("loading");

        var params = 'service_name=' + app.serviceName +
            '&search_id=' + app.vars.searchId +
            '&' + $("#dictionary-form").serialize();

        $.post('/dictionary/search' + type, params, function(data) {
            if (data.status == 'ok') {
                $("#dictionary-search-result").html(data.html);
                $(".dictionary-table tbody tr").click(function() {
                    if ($(this).hasClass("info")) {
                        $(this).removeClass("info");
                        $(this).find("input").prop("checked", false);
                    } else {
                        $(this).addClass("info");
                        $(this).find("input").prop("checked", true);
                    }
                });
            } else {
                app.alert(data.errors);
            }
            $(".dictionary-search-btn").button("reset");
        }, 'json');
    };

    // 商標→称呼辞書検索
    app.searchDictionary103 = function() {
        $(".shoko-dictionary-search-btn").button("loading");

        var conditionTable = $(this).closest(".condition-table");
        var shohyo = conditionTable.find(".dictionary-search-shohyo").val();
        var searchResult = conditionTable.find(".shoko-dictionary-search-result");
        var params = 'service_name=' + app.serviceName +
            '&search_id=' + app.vars.searchId +
            '&type=3&col=0&str0=' + encodeURIComponent(shohyo);

        $.post('/dictionary/search103', params, function(data) {
            if (data.status == 'ok') {
                searchResult.html(data.html);
                searchResult.find(".dictionary-table tbody tr").click(function() {
                    if ($(this).hasClass("info")) {
                        $(this).removeClass("info");
                        $(this).find("input").prop("checked", false);
                    } else {
                        $(this).addClass("info");
                        $(this).find("input").prop("checked", true);
                    }
                });
            } else {
                app.alert(data.errors);
            }
            $(".shoko-dictionary-search-btn").button("reset");
        }, 'json');
    };

    // 称呼辞書内容をフォームにセット
    app.setShokoDictionaryItem = function() {
        var conditionTable = $(this).closest(".condition-table");
        var selectedRows = conditionTable.find(".shoko-dictionary-search-result tr.info");

        if (selectedRows.length == 0) {
            alert("リストから称呼を選択してください");
        }

        var names = conditionTable.find(".dictionary-search-names");
        var value = names.val();
        var values = [];
        if (value != '') {
            values = value.split("/\r?\n/");
        }

        selectedRows.each(function() {
            values.push($(this).attr('data-value'));
        });

        value = values.join("\r\n");
        names.val(value);
    };

    // 同一検索実行
    app.sameSearch = function(formId) {
        if (app.vars.waitingResponse) return;

        var params = $("#" + formId).serialize();
        params += '&search_id=' + app.vars.searchId;

        $(".same-search-btn").button("loading");
        app.vars.waitingResponse = true;
        app.clearError();

        $.ajax({
            type: 'POST',
            url: '/ruijipro/samesearch',
            data: params,
            dataType: 'json'
        }).done(function(data) {
            if (data.status == 'ok') {
                app.vars.searchedItems = data.values.items;
                countList.setCountListFromItems(data.values.items);
                if (app.vars.callSimilarSearch) {
                    app.vars.callSimilarSearch = false;
                    if (data.values.needsSimilarSearch) {
                        app.similarSearch();
                    }
                }
                $(".search-form").hide();
                $(".count-form").show();
            } else {
                app.showError(data.errors);
            }
        }).always(function() {
            $(".same-search-btn").button("reset");
            app.vars.waitingResponse = false;
        });
    };

    // 類似検索実行
    app.similarSearch = function() {
        $("#similar-search-btn").button("loading");

        var params = $("#search-condition-form").serialize() + '&' + $("#count-form").serialize();
        params += '&search_id=' + app.vars.searchId;
        if (app.vars.similarSearchFristIndex) {
            params += '&first_index=' + app.vars.similarSearchFristIndex;
            app.vars.similarSearchFristIndex = null;
        }

        $.ajax({
            type: 'POST',
            url: '/ruijipro/similarsearch',
            data: params,
            dataType: 'json'
        }).done(function(data) {
            if (data.status == 'ok') {
                countList.removeCountListRowIfNotExists(data.values.items);
                var rows = $(".count-list-row");
                app.vars.searchedItems = data.values.items;
                data.values.items.forEach(function(item, i) {
                    var row = rows.eq(i);
                    countList.setSimilarSearchCountFromItem(item, row);
                    countList.updateListBtnAndMergeCheck(row);
                });
            } else {
                app.showError(data.errors);
            }
        }).always(function() {
            $("#similar-search-btn").button("reset");
        });
    };

    // 類似絞込実行
    app.similarFilter = function() {
        if (app.vars.waitingResponse) return;

        // 送信するパラメータを作成
        var params = app.getFilterParams();
        params += '&index=' + app.vars.countListRowIndex;

        $("#filter-btn").button("loading");
        app.vars.waitingResponse = true;

        $.ajax({
            type: 'POST',
            url: '/ruijipro/similarfilter',
            data: params,
            dataType: 'json'
        }).done(function(data) {
            if (data.status == 'ok') {
                countList.removeCountListRowIfNotExists(data.values.items);
                var rows = $(".count-list-row");
                app.vars.searchedItems = data.values.items;
                var item = data.values.items[app.vars.countListRowIndex];
                var row = rows.eq(app.vars.countListRowIndex);
                countList.setSimilarSearchCountFromItem(item, row);
                countList.updateListBtnAndMergeCheck(row);
            } else {
                app.showError(data.errors);
            }
        }).always(function() {
            $("#filter-btn").button("reset");
            $("#similar-filter-modal").modal('hide');
            app.vars.waitingResponse = false;
        });
    };

    // 限定実行
    app.limit = function() {
        if (app.vars.waitingResponse) return;

        var params = 'search_id=' + app.vars.searchId +
            '&index=' + app.vars.countListRowIndex +
            '&' + $("#limit-form").serialize();

        $("#limit-btn").button("loading");
        app.vars.waitingResponse = true;
        app.clearError();

        $.ajax({
            type: 'POST',
            url: '/ruijipro/limit',
            data: params,
            dataType: 'json'
        }).done(function(data) {
            if (data.status == 'ok') {
                var rows = $(".count-list-row");
                app.vars.searchedItems = data.values.items;
                var item = data.values.items[app.vars.countListRowIndex];
                var row = rows.eq(app.vars.countListRowIndex);
                countList.setSameSearchCountFromItem(item, row);
                countList.updateListBtnAndMergeCheck(row);
                $("#limit-condition-modal").modal('hide');
            } else {
                app.showError(data.errors, ".limit-modal-error");
            }
        }).always(function() {
            $("#limit-btn").button("reset");
            app.vars.waitingResponse = false;
        });
    };

    app.merge = function() {
        if (app.vars.waitingResponse) return;

        app.vars.waitingResponse = true;

        $(".merge-btn").button("loading");

        var type = $(this).attr("data-type");
        var params = 'search_id=' + app.vars.searchId +
            '&type=' + type +
            '&' + $("#count-form").serialize();

        $.ajax({
            type: 'POST',
            url: '/ruijipro/merge',
            data: params,
            dataType: 'json'
        }).done(function(data) {
            if (data.status == 'ok') {
                app.vars.searchedItems = data.values.items;
                countList.setCountListFromItems(data.values.items);
            } else {
                app.showError(data.errors);
            }
        }).always(function() {
            $(".merge-btn").button("reset");
            app.vars.waitingResponse = false;
        });
    };

    app.saveListData = function(index, callback) {
        if (app.vars.waitingResponse) return;

        app.vars.waitingResponse = true;

        var params = 'index=' + index + '&search_id=' + app.vars.searchId + '&' + $("#count-form").serialize();

        $.ajax({
            type: 'POST',
            url: '/ruijipro/savesearchresult',
            data: params,
            dataType: 'json'
        }).done(function(data) {
            if (data.status == 'ok') {
                callback();
            } else {
                app.showError(data.errors);
            }
        }).always(function() {
            $(".merge-btn").button("reset");
            app.vars.waitingResponse = false;
        });
    };

    app.saveListDataForFilter = function(callback) {
        var params = 'search_id=' + app.vars.searchId;

        $.ajax({
            type: 'POST',
            url: '/ruijipro/savelistdata',
            data: params,
            dataType: 'json'
        }).done(function(data) {
            if (data.status == 'ok') {
                callback();
            } else {
                app.showError(data.errors);
            }
        });
    };

    // 称呼追加フォーム表示
    app.showAddShokoForm = function() {
        $("#add-shoko-search-form [name=names]").val("");
        $(".count-form").hide();
        $(".search-form").hide();
        $("#add-shoko-search-form").show();
    };

    // 件数リスト表示
    app.showCountList = function() {
        app.clearError();
        $(".search-form").hide();
        $(".count-form").show();
    };

    // 検索条件変更フォーム表示
    app.showChangeSearchConditionForm = function() {
        $(".count-form").hide();
        $(".search-form").hide();
        $("#change-search-condition-form").show();
    };

    // 検索フォーム表示（件数一覧から）
    app.showSearchConditionFromCountList = function() {
        $(".count-form").hide();
        $(".search-form").hide();
        app.clearError();
        countList.resetAllChargeStatus();
        $("#search-condition-form").show();
    };

    // 限定条件表示
    app.showLimitCondition = function(index) {
        var item = app.vars.searchedItems[index].same_search_desc;

        $('#limit-form [name="level"]').val([item.level]);

        for (var i=1; i<=4; i++) {
            $('#limit-form [name="llp[' + i + ']"]').val(item.lower_limit_pronunciations_map[i]);
            $('#limit-form [name="ulp[' + i + ']"]').val(item.upper_limit_pronunciations_map[i]);
            $('#limit-form [name="sp[' + i + ']"]').val(item.specified_pronunciations_map[i]);
        }

        app.clearError();
        $("#limit-condition-modal").modal();
    };

    // 類似絞込条件表示
    app.showSimilarFilterCondition = function() {
        if (!app.vars.filterTemplates) {
            app.vars.filterTemplates = {};
        }

        var params = 'search_id=' + app.vars.searchId +
            '&index=' + app.vars.countListRowIndex;

        $.get('/ruijipro/similarfiltercondition', params, function(data) {
            if (data.status == 'ok') {
                var rows = $(".count-list-row");
                var row = rows.eq(app.vars.countListRowIndex);
                countList.chargeSimilarSearch(row);
                countList.updateAllRowsChargeStatus();
                app.setFilterConditionTable(data.values, 'shoko');
                app.updateChargeNums();
                app.updateFilterListDisplay('shoko');
                $("#similar-filter-modal").modal();
            }
        }, 'json');
    };

    app.updateList = function(page, callback) {
        var url = app.getUpdateListUrl(page);

        if ($('#list').is(':visible')) {
            app.showLoading();
        }

        $("#list").load(url, function() {
            app.setListAndDetailLayout();
            app.setListHeaderColAction();
            app.setListRowHelpAction();
            app.setListRowDetailBtnClickEvent();
            app.scrollToSelectedListNo();
            app.updateChargeNums();

            if ($('#loading-modal').is(':visible')) {
                app.hideLoading();
            }

            if (callback && typeof(callback) == 'function') {
                callback();
            }
        });
    };

    app.showSearchCondition = function() {
        app.hideDetail();
        $("#list").empty();
        $("#list-header").hide();
        $(".search-result").hide();
        $(".count-form").show();
        app.showInfosonarFooter();
    };

    app.getConditionParams = function() {
        var params = 'search_id=' + app.vars.searchId;
        params += '&' + $("#search-condition-form").serialize();
        return params;
    };

    app.setConditionToForm = function(condition) {
        var typeMap = {
            '103': 'names',
            '106': 'similar_code',
            '104': 'international_class'
        };
        $.each(condition.condition_desc_array, function(i, item) {
            var name = typeMap[item.type];
            $("textarea[name=" + name + "]").val(item.str);
        });
        $(".dictionary-search-shohyo").val("");
        $(".shoko-dictionary-search-result").empty();

        // 追加条件をセット
        $("input[name=sonzoku_kind]").val([condition.extra_condition_map.sonzoku_kind]);
        $("input[name=sikko_kind]").val([condition.extra_condition_map.sikko_kind]);
        $("input[name=shukya_kind]").val([condition.extra_condition_map.shukya_kind]);
        $("input[name=cb_1]").val([condition.extra_condition_map.reg_kind]);
        app.setSearchFilterLabel("search-condition-form");
    };
</script>

<div style="display: none;" class="no-print-with-modal">
    <!-- 入力番号 -->
<div id="help-list-INP_NO">
    条件入力された番号をそのまま表示
</div>

<!-- 表示番号 -->
<div id="help-list-DSP_NO">
    検索された商標の登録番号または出願番号を表示（登録番号優先）<br>
    分割番号は半角ハイフンにて連結、防護番号はカッコ付で表示<br>
    ・国内登録、国内出願　→　番号のみ<br>
    ・国際登録　→　先頭に「国」
</div>

<!-- 登録番号 -->
<div id="help-list-DSP_REG_NO">
    登録番号および国際登録番号を表示<br>
    マドプロの場合、先頭に「国」を付加
</div>

<!-- 出願番号 -->
<div id="help-list-DSP_APP_NO">
    出願番号を表示<br>
    マドプロの場合、表示無し
</div>

<!-- 登録日 -->
<div id="help-list-REG_DATE">
    国内登録日を表示
</div>

<!-- 出願日 -->
<div id="help-list-APP_DATE">
    出願日を表示<br>
    マドプロの場合には事後指定日または国際登録日を表示(事後指定日優先)
</div>

<!-- 登録番号／登録日 -->
<div id="help-list-DSP_REG_NO-REG_DATE">
    登録番号と登録日を１項目中に２段で表示<br>
    登録番号を表示。マドプロの場合、先頭に「国」を付加<br>
    国内登録日
</div>

<!-- 出願番号／出願日 -->
<div id="help-list-DSP_APP_NO-APP_DATE">
    出願番号と出願日を１項目中に２段で表示<br>
    国内データの場合、上段に出願番号、下段に出願日を表示<br>
    マドプロの場合には上段に国際登録日を、下段に事後指定日を表示
</div>

<!-- 失効 -->
<div id="help-list-KENRI_FLG">
    権利失効データの場合、「※」を表示
</div>

<!-- 登録 -->
<div id="help-list-REG_FLG">
    登録済の場合、「登」を表示
</div>

<!-- 出願種別 -->
<div id="help-list-APP_KIND">
    通常，連合，防護，分割，補却，変更，優先，団体，地域，特例（小売特例主張）
</div>

<!-- 付加情報 -->
<div id="help-list-ADD_INFO">
    色彩：色彩有　，　図形：図形有　，　５４：５条４項　，　３２：３条２項　，<br>
    標準：標準文字　，　９１：９条１項　，　重複：重複出願<br>
    権不：権利不要求　，　同否：同意併存登録否認　，　同是：同意併存登録是認
</div>

<!-- 商標タイプ -->
<div id="help-list-TMARK_TYPE">
    立体：立体商標　，　音：音商標　，　動き：動き商標　，<br>
    ホログラム：ホログラム商標　，　色彩のみ：色彩のみからなる商標　，<br>
    位置：位置商標
</div>

<!-- イメージ -->
<div id="help-list-LSTIMG">
    商標見本部イメージ。複数イメージの場合には１枚目のみを表示
</div>

<!-- 商標 -->
<div id="help-list-TMARK">
    表示用商標
</div>

<!-- 商品の詳細な説明 -->
<div id="help-list-SHOSAI_SETSUMEI">
    一覧表示は１２７文字(全角)まで表示。<br>
    エクセル・CSVダウンロードでは文字数制限を超える場合には4000バイトまで出力
</div>

<!-- 法 -->
<div id="help-list-HO_KBN">
    法区分をコードで表示<br>
    <table>
        <tbody><tr>
            <td>
                　Ｕ：国際分類第12版（R05. 1. 1.施行）<br>
                　Ｖ：国際分類第11版（H29. 1. 1.施行）<br>
                　Ｗ：国際分類第10版（H24. 1. 1.施行）<br>
                　Ｘ：国際分類第９版（H19. 1. 1.施行）<br>
                　Ｙ：国際分類第８版（H14. 1. 1.施行）<br>
                　Ｚ：平成８年法　（H09. 4. 1.施行）
            </td>
            <td>
                　０：平成３年法　（H04. 4. 1.施行）<br>
                　１：昭和３４年法（S35. 4. 1.施行）<br>
                　２：大正１０年法（T11.11. 1.施行）<br>
                　３：明治４２年法（M42.11. 1.施行）<br>
                　４：明治３２年法（M32. 7. 1.施行）
            </td>
        </tr>
    </tbody></table>
</div>

<!-- 法区分記事 -->
<div id="help-list-HO_KBN_KIJI">
    法区分を日本語表示<br>
    <table>
        <tbody><tr>
            <td>
                　国際分類第12版（R05. 1. 1.施行）<br>
                　国際分類第11版（H29. 1. 1.施行）<br>
                　国際分類第10版（H24. 1. 1.施行）<br>
                　国際分類第９版（H19. 1. 1.施行）<br>
                　国際分類第８版（H14. 1. 1.施行）<br>
                　平成８年法　（H09. 4. 1.施行）
            </td>
            <td>
                　平成３年法　（H04. 4. 1.施行）<br>
                　昭和３４年法（S35. 4. 1.施行）<br>
                　大正１０年法（T11.11. 1.施行）<br>
                　明治４２年法（M42.11. 1.施行）<br>
                　明治３２年法（M32. 7. 1.施行）
            </td>
        </tr>
    </tbody></table>
</div>

<!-- 分類 -->
<div id="help-list-CLASS">
    法区分に対応した分類を表示
</div>

<!-- 区分数 -->
<div id="help-list-CLASS_NUM">
    法区分に対応した分類の個数を表示
</div>

<!-- 出願人／権利者 -->
<div id="help-list-KENRI_NAME">
    出願人／権利者を表示
</div>

<!-- 出願人／権利者住所 -->
<div id="help-list-KENRI_ADDRESS">
    出願人／権利者住所を表示
</div>

<!-- 出願人／権利者数 -->
<div id="help-list-KENRI_NUM">
    出願人／権利者数（共願の数）を表示
</div>

<!-- 存続満了日／分納満了日 -->
<div id="help-list-FINAL_DATE-BUN_DATE">
    上段に存続期間満了日を、「満」を付加して表示<br>
    下段に分納満了日を、「分」を付加して表示<br>
    ※分納満了日は後半の５年分が納付された時点で日付が消えます。
</div>

<!-- 中間記録 -->
<div id="help-list-PRGRS_REC">
    一覧表示は最新記事（末尾から）５行のみを表示<br>
    エクセル・CSVダウンロードでは文字数制限を超える場合には最新記事の4000バイトを出力
</div>

<!-- 審査条文 -->
<div id="help-list-SSJ_CODE">
    審査条文コードを表示<br>
    コードにカーソルを合わせると対応内容を表示
</div>

<!-- 審査条文記事 -->
<div id="help-list-SSJ_KIJI">
    審査条文コードに対応した内容を表示
</div>

<!-- 審判条文 -->
<div id="help-list-SPJ_CODE">
    審判条文コードを表示<br>
    コードにカーソルを合わせると対応内容を表示
</div>

<!-- 審判条文記事 -->
<div id="help-list-SPJ_KIJI">
    審判条文コードに対応した内容を表示
</div>

<!-- 審判番号 -->
<div id="help-list-APPL_NO">
    審判番号を表示
</div>

<!-- 審判 -->
<div id="help-list-APPL_NO_UMU">
    審判有の場合「有」を表示
</div>

<!-- 最終処分 -->
<div id="help-list-SB_CODE">
    最終処分コードを表示
</div>

<!-- 最終処分記事 -->
<div id="help-list-SB_KIJI">
    最終処分内容を表示
</div>

<!-- 称呼 -->
<div id="help-list-SHOKO">
    特許庁称呼
</div>

<!-- 国内代理人 -->
<div id="help-list-DAIRI_NAME">
    代理人を表示。マドプロの場合は国内代理人
</div>

<!-- 類似群コード -->
<div id="help-list-RUIJIGUN">
    類似群コードを最大４２個まで表示。４３個以上ある場合には末尾に「...」を付加
</div>

<!-- 指定商品／役務名 -->
<div id="help-list-SHOHIN_NAME">
    分類＋指定商品／役務名を最大１２７文字(全角)まで表示。１２７文字を超える場合には１２６文字＋末尾に「...」を付加して表示
</div>

<!-- ウィーン図形分類 -->
<div id="help-list-FIGTERM">
    ウィーンコードのみ表示<br>
    WIPOにて付与された「ウイーン分類」を基本に、特許庁により細分化された「細分化ウイーン分類」を表示<br>
    詳細は図形等分類表｜J-PlatPat参照
</div>

<!-- ウィーン図形分類記事 -->
<div id="help-list-FIGTERM_KIJI">
    ※図形検索ダウンロードのみで指定可能<br>
    ウィーンコード＋ウィーンコード説明を表示<br>
    WIPOにて付与された「ウイーン分類」を基本に、特許庁により細分化された「細分化ウイーン分類」を表示<br>
    詳細は図形等分類表｜J-PlatPat参照
</div>

<!-- マドプロ -->
<div id="help-list-MAD_FLG">
    国内／マドプロデータ識別。マドプロデータの場合「国」を表示
</div>

<!-- 国県コード -->
<div id="help-list-KUNI_CODE">
    出願人／権利者の国県コードを表示<br>
    マドプロデータは国県コードを持たないため、本国官庁コードを使用
</div>

<!-- 国県名 -->
<div id="help-list-KUNI_KIJI">
    出願人／権利者の国県コードに対応した国県名を表示<br>
    マドプロデータは国県コードを持たないため、本国官庁コードを使用
</div>

<!-- J-PlatPat商標照会 -->
<div id="help-list-JPP_URL">
    INPITが運営するJ-PlatPatへリンク
</div>
    <div id="help-kyozetsu-jp-30">第3条1項各号</div>
<div id="help-kyozetsu-jp-31">第3条1項各号+第4条1項16号</div>
<div id="help-kyozetsu-jp-32">第3条1項柱書</div>
<div id="help-kyozetsu-jp-33">第3条1項柱書(定型文付)</div>
<div id="help-kyozetsu-jp-34">第3条1項柱書(定型文､但し書付)</div>
<div id="help-kyozetsu-jp-40">第4条1項各号(第4条1項11号～13号除く)</div>
<div id="help-kyozetsu-jp-41">第4条1項11号</div>
<div id="help-kyozetsu-jp-42">第4条1項12号</div>
<div id="help-kyozetsu-jp-43">第4条1項13号</div>
<div id="help-kyozetsu-jp-44">第4条1項11号(番号列記)</div>
<div id="help-kyozetsu-jp-45">第8条1項+第4条1項11号</div>
<div id="help-kyozetsu-jp-46">第4条1項16号</div>
<div id="help-kyozetsu-jp-47">第19条2項(公益的不登録理由)</div>
<div id="help-kyozetsu-jp-48">更新(住所相違)</div>
<div id="help-kyozetsu-jp-49">更新(氏名相違)</div>
<div id="help-kyozetsu-jp-52">第3条柱書+第4条1項11号</div>
<div id="help-kyozetsu-jp-53">第3条各号+第4条1項11号</div>
<div id="help-kyozetsu-jp-54">第4条各号+第4条1項11号</div>
<div id="help-kyozetsu-jp-55">その他+第4条1項11号</div>
<div id="help-kyozetsu-jp-60">条文なし</div>
<div id="help-kyozetsu-jp-61">第6条1項</div>
<div id="help-kyozetsu-jp-62">第6条1項(防護)又は第6条2項(防護)</div>
<div id="help-kyozetsu-jp-63">第6条1項+第6条2項</div>
<div id="help-kyozetsu-jp-64">第64条(防護)</div>
<div id="help-kyozetsu-jp-65">第6条1項(防護)+第6条2項(防護)</div>
<div id="help-kyozetsu-jp-66">第6条1項又は第6条2項</div>
<div id="help-kyozetsu-jp-67">第6条1項(防護)</div>
<div id="help-kyozetsu-jp-68">防護更新</div>
<div id="help-kyozetsu-jp-69">第6条2項</div>
<div id="help-kyozetsu-jp-71">第7条1項(商標･商品類似)</div>
<div id="help-kyozetsu-jp-72">第7条1項(番号列記)</div>
<div id="help-kyozetsu-jp-73">第7条3項(商標非類似)</div>
<div id="help-kyozetsu-jp-74">第7条の2第1項</div>
<div id="help-kyozetsu-jp-75">第7条3項(商品非類似)</div>
<div id="help-kyozetsu-jp-76">第7条3項(商標･商品非類以)</div>
<div id="help-kyozetsu-jp-77">附則第4条1項(指定商品の拡大)</div>
<div id="help-kyozetsu-jp-78">附則第4条1項(書換区分相違)</div>
<div id="help-kyozetsu-jp-79">附則第6条2項(氏名･名称相違)</div>
<div id="help-kyozetsu-jp-80">附則第6条2項(住所相違)</div>
<div id="help-kyozetsu-jp-81">附則第6条2項(氏名及び住所相違)</div>
<div id="help-kyozetsu-jp-82">第3条柱書+第8条1項+第4条1項11号</div>
<div id="help-kyozetsu-jp-83">第3条各号+第8条1項+第4条1項11号</div>
<div id="help-kyozetsu-jp-84">第4条各号+第8条1項+第4条1項11号</div>
<div id="help-kyozetsu-jp-85">その他+第8条1項+第4条1項11号</div>
<div id="help-kyozetsu-jp-92">第3条柱書+その他(第4条1項11号を除く)</div>
<div id="help-kyozetsu-jp-93">第3条各号+その他(第4条1項11号を除く)</div>
<div id="help-kyozetsu-jp-94">第4条各号+その他(第4条1項11号を除く)</div>
<div id="help-kyozetsu-jp-95">その他(第4条1項11号を除く)</div>
<div id="help-kyozetsu-jp-S00">その他</div>
<div id="help-kyozetsu-jp-S01">3条1項各号+その他</div>
<div id="help-kyozetsu-jp-S02">3条1項各号+4条1項16号+その他</div>
<div id="help-kyozetsu-jp-S03">4条1項各号(11号は除く)+その他</div>
<div id="help-kyozetsu-jp-S04">4条1項11号+その他</div>
<div id="help-kyozetsu-jp-S30">3条1項各号</div>
<div id="help-kyozetsu-jp-S31">3条1項各号、4条1項16号</div>
<div id="help-kyozetsu-jp-S32">3条1項各号+4条1項各号(11号は除く)</div>
<div id="help-kyozetsu-jp-S33">3条1項各号+4条1項11号</div>
<div id="help-kyozetsu-jp-S34">3条1項各号+4条1項16号+4条1項各号(11号は除く)</div>
<div id="help-kyozetsu-jp-S35">3条1項各号+4条1項16号+4条1項11号</div>
<div id="help-kyozetsu-jp-S36">3条1項各号+4条1項各号(11号は除く)+4条1項11号</div>
<div id="help-kyozetsu-jp-S37">3条1項各号+4条1項16号+4条1項11号+4条1項各号(11号は除く)</div>
<div id="help-kyozetsu-jp-S40">4条1項各号(11号は除く)</div>
<div id="help-kyozetsu-jp-S41">4条1項11号</div>
<div id="help-kyozetsu-jp-S42">4条1項各号(11号は除く)+4条1項11号</div>
<div id="help-kyozetsu-jp-S47">21条1項</div>
<div id="help-kyozetsu-jp-S71">7条1項</div>
<div id="help-kyozetsu-jp-S73">7条3項</div>
<div id="help-kyozetsu-jp-S74">第7条の2第1項</div>

<div id="help-kyozetsu-mad-11">第6条1項</div>
<div id="help-kyozetsu-mad-12">第6条2項</div>
<div id="help-kyozetsu-mad-13">第6条1項+第6条2項</div>
<div id="help-kyozetsu-mad-21">第3条1項1号+4条第1項16号</div>
<div id="help-kyozetsu-mad-22">第3条1項2号+4条第1項16号</div>
<div id="help-kyozetsu-mad-23">第3条1項3号+4条第1項16号</div>
<div id="help-kyozetsu-mad-24">第3条1項4号+4条第1項16号</div>
<div id="help-kyozetsu-mad-25">第3条1項5号+4条第1項16号</div>
<div id="help-kyozetsu-mad-26">第3条1項6号+4条第1項16号</div>
<div id="help-kyozetsu-mad-30">第3条柱書</div>
<div id="help-kyozetsu-mad-31">第3条1項1号</div>
<div id="help-kyozetsu-mad-32">第3条1項2号</div>
<div id="help-kyozetsu-mad-33">第3条1項3号</div>
<div id="help-kyozetsu-mad-34">第3条1項4号</div>
<div id="help-kyozetsu-mad-35">第3条1項5号</div>
<div id="help-kyozetsu-mad-36">第3条1項6号</div>
<div id="help-kyozetsu-mad-41">第4条1項1号</div>
<div id="help-kyozetsu-mad-42">第4条1項2号</div>
<div id="help-kyozetsu-mad-43">第4条1項3号</div>
<div id="help-kyozetsu-mad-44">第4条1項4号</div>
<div id="help-kyozetsu-mad-45">第4条1項5号</div>
<div id="help-kyozetsu-mad-46">第4条1項6号</div>
<div id="help-kyozetsu-mad-47">第4条1項7号</div>
<div id="help-kyozetsu-mad-48">第4条1項8号</div>
<div id="help-kyozetsu-mad-49">第4条1項9号</div>
<div id="help-kyozetsu-mad-50">第4条1項10号</div>
<div id="help-kyozetsu-mad-51">第4条1項11号</div>
<div id="help-kyozetsu-mad-52">第4条1項12号</div>
<div id="help-kyozetsu-mad-53">第4条1項13号</div>
<div id="help-kyozetsu-mad-54">第4条1項14号</div>
<div id="help-kyozetsu-mad-55">第4条1項15号</div>
<div id="help-kyozetsu-mad-56">第4条1項16号</div>
<div id="help-kyozetsu-mad-57">第4条1項17号</div>
<div id="help-kyozetsu-mad-58">第4条1項18号</div>
<div id="help-kyozetsu-mad-59">第4条1項19号</div>
<div id="help-kyozetsu-mad-74">第7条の2第1項</div>
<div id="help-kyozetsu-mad-82">第8条2項</div>
<div id="help-kyozetsu-mad-85">第8条5項</div>
<div id="help-kyozetsu-mad-86">第8条2項+第8条5項</div>
<div id="help-kyozetsu-mad-90">条文なし</div>
<div id="help-kyozetsu-mad-99">その他</div></div>

<div class="modal fade" tabindex="-1" role="dialog" id="loading-modal">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-body text-center">
                <i class="fa fa-spinner fa-spin "></i> 読み込み中
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->



<div id="workspace" style="display: none;"></div></body>